<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf=8">
        <title>Drumkit</title>
    </head>
    <link rel="stylesheet" href="style.css">
    <!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
    <body style="background-image: url(./images/tim-toomey-eiY4KJ62P5Q-unsplash.jpg)">
        <div class="heading">
            <h1 class="headingtitleo">Drum</h1>
            <img class="dru"src="./images/drumkit.png">   
            <h1 class="headingtitlet">Kit</h1> 
            <P id = "instruction">Keep Caps Lock On</P>
        </div>
        <div class="drumkeys">
            <button type="button" class="btn btn-outline-dark drumW">W</button>
            <button type="button" class="btn btn-outline-dark drumA">A</button>
            <button type="button" class="btn btn-outline-dark drumS">S</button>
            <button type="button" class="btn btn-outline-dark drumD">D</button>
            <button type="button" class="btn btn-outline-dark drumJ">J</button>
            <button type="button" class="btn btn-outline-dark drumK">K</button>
            <button type="button" class="btn btn-outline-dark drumL">L</button>
        </div>
        <input type="file" accept="audio/*" capture id="recorder">
<audio id="player" controls></audio>
<a id="download">Download</a>
<button id="stop">Stop</button>
<script>
  let shouldStop = false;
  let stopped = false;
  const downloadLink = document.getElementById('download');
  const stopButton = document.getElementById('stop');

  stopButton.addEventListener('click', function() {
    shouldStop = true;
  });

  const handleSuccess = function(stream) {
    const options = {mimeType: 'audio/webm'};
    const recordedChunks = [];
    const mediaRecorder = new MediaRecorder(stream, options);

    mediaRecorder.addEventListener('dataavailable', function(e) {
      if (e.data.size > 0) {
        recordedChunks.push(e.data);
      }

      if(shouldStop === true && stopped === false) {
        mediaRecorder.stop();
        stopped = true;
      }
    });

    mediaRecorder.addEventListener('stop', function() {
      downloadLink.href = URL.createObjectURL(new Blob(recordedChunks));
      downloadLink.download = 'acetest.wav';
    });

    mediaRecorder.start();
  };

  navigator.mediaDevices.getUserMedia({ audio: true, video: false })
      .then(handleSuccess);

</script>

<script src="index.js" charset="utf-8"></script>   
</body>

</html>
